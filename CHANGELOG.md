# 芸仔AI 更新日志

## [2.0.0] - 2026-01-20

### 🎨 UI 重构 - 豆包风格

#### 新增
- **设计系统**：全新的豆包风格设计系统
  - 柔和蓝色主题 (#0066FF)
  - 大圆角设计 (12px-20px)
  - 柔和阴影效果
  - 宽松的间距布局

- **MainLayout 组件**：新的主布局组件
  - 可折叠侧边栏
  - 响应式设计（移动端抽屉式）
  - 用户信息展示

- **Sidebar 组件**：全新侧边栏
  - 导航菜单高亮
  - 新建对话快捷按钮
  - 用户状态显示

- **首页重构**
  - 侧边栏 + 中心卡片 + 底部输入框布局
  - AI 工具卡片网格展示
  - 快捷提示词
  - 公告横幅

#### 变更
- 更新 Tailwind 配置，添加豆包风格变量
- 更新全局 CSS，添加组件类名
- 优化卡片悬停效果和动画

### 🔧 工作流编辑器 V2

#### 新增
- **多步骤串联**：支持多个步骤顺序执行
- **每步骤模型选择**：每个 AI 调用步骤可独立选择模型
- **步骤类型**：
  - `prompt`: AI 调用（支持系统提示词、温度、最大 Token）
  - `condition`: 条件分支（即将推出）
  - `transform`: 数据转换
  - `output`: 输出

- **预设模板**：
  - AI 对话
  - 翻译
  - 摘要
  - 分析
  - 格式化
  - 输出

- **可视化编辑**：
  - 步骤节点可展开/折叠
  - 步骤上下移动
  - 步骤删除确认
  - 连接线指示器

#### 文件结构
```
WorkflowEditor/
├── types.ts              # 类型定义
├── StepNode.tsx          # 步骤节点组件
├── StepPalette.tsx       # 步骤选择面板
├── useWorkflowEditorV2.ts # 状态管理Hook
└── WorkflowEditorV2.tsx  # 主视图组件
```

### 🐛 Bug 修复

#### 登录状态持久化
- **问题**：登录成功后跳转到 /admin 页面显示"未登录"
- **原因**：Zustand 状态写入和页面导航存在竞态条件
- **解决方案**：
  - 添加 `setAuth()` 原子操作方法
  - 添加 `isHydrated` 水合状态跟踪
  - 添加 `syncAuthFromStorage()` 状态同步函数
  - 增加状态同步等待时间 (150ms)

### 📚 文档

- 新增 `docs/UI-REFACTOR-GUIDE.md` - UI 重构指南
- 新增 `CHANGELOG.md` - 更新日志

### 🔜 后续计划

1. 条件分支功能完善
2. 拖拽排序步骤
3. 工作流版本历史
4. 工作流模板市场
5. 切换到生产模式构建
6. Docker 部署配置

---

## [1.0.0] - 初始版本

- 基础聊天功能
- 用户认证系统
- 管理员后台
- 工作流基础功能
- 激活码系统
- 法律合规模块
